## 5. 합성곱 신경망(CNN)
### 5.1 합성곱 신경망의 기본 개념과 구조
- 기존 신경망(DNN)은 이미지가 커질수록 학습량이 지나치게 증가 -> 계산 효율 하락
- CNN은 2D의 구조를 유지, 파라미터 공유 -> 효율성 증가
- CNN의 특징
  - 지역적 연결성 : 각 이미지의 일부 영역에만 연결 -> 특정 부분의 특징을 효과적으로 파악 (not 전체)
  - 파라미터 공유 : 각 레이어에 동일한 필터가 적용 -> 학습할 파라미터 수 감소
  - 평행 이동 불변성 : 객체 위치가 달라져도 동일 특징 감지
### 5.2 합성곱 신경망의 주요 구성 요소
- 합성곱 레이어
  - 필터(커널) : 가중치 행렬
 ![743E548E-6D76-4350-9438-7C1A68C55967_4_5005_c](https://github.com/user-attachments/assets/1161c026-dd37-4fdb-8f94-5367dca5213b)
(출처 : https://wiki1.kr/index.php?title=합성곱_신경망&mobileaction=toggle_view_desktop)
  - 필터의 동작 원리 : 밝기가 급격히 바뀌는 경계에서 큰 값이 생성
  - 스트라이드 : 필터가 이동하는 간격 n이라고 했을 때 n 픽셀씩 이동
  - 패딩 : 입력 이미지 가장자리에 추가되는 픽셀
  - 출력 특성 맵의 크기 : 출력크기 = (입력크기- 필터크기十2X패딩)/스트라이드十1
- 활성화 함수와 비선형
  - ReLU

| 활성화 함수 | 수식 (텍스트) | 특징 | 장점 | 단점 / 주의점 | 목적 |
|------------|--------------|------|------|--------------|------|
| Leaky ReLU | f(x) = max(0.01x, x) | 음수 구간에 작은 기울기 | Dying ReLU 완화 | 기울기 값 수동 설정 | ReLU 개선 |
| ELU | x (x > 0), α(e^x - 1) (x ≤ 0) | 음수 구간이 부드러운 곡선 | 평균 활성화 0 근처 | 계산량 증가 | 학습 안정화 |
| SELU | Scaled ELU | 자기 정규화 특성 | 깊은 네트워크 안정 | 조건 제한 있음 | 깊은 모델 |
| Swish | f(x) = x * sigmoid(x) | 부드러운 비단조 함수 | 성능 우수 | 계산량 증가 | 성능 최적화 |

- 풀링 레이어
  - 최대 풀링 : 윈도우 내 가장 큰 값 선택
  - 평균 풀링 : 윈도우 내 값들의 평균
  - 풀링의 효과 : 파라미터 수 감소, 과적합 방지, 수용 영역 확대
  - 풀링 레이어 설계시 주의 사항 : 풀링 레이어가 너무 많으면 정보 손실 위험, 스트라이드는 풀링의 크기와 동일하게 설정
- 파이토치를 이용한 합성곱 신경망 구현

| 레이어            | 역할    | 설명                                                  | 주요 파라미터                                                                                                                                  |
| -------------- | ----- | --------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| `nn.Conv2d`    | 특징 추출 | 이미지와 같은 2차원 입력에 여러 개의 커널(필터)을 적용하여 에지, 패턴 등의 특징을 추출 | `in_channels` : 입력 특징 맵 채널 수<br>`out_channels` : 출력 특징 맵 채널 수(필터 개수)<br>`kernel_size` : 커널 크기<br>`stride` : 이동 간격<br>`padding` : 가장자리 패딩 |
| `nn.MaxPool2d` | 특징 축소 | 특징 맵에서 가장 큰 값만 선택하여 공간 크기를 줄이고 중요한 정보만 유지           | `kernel_size` : 풀링 윈도우 크기<br>`stride` : 이동 간격                                                                                            |



